{% extends 'base.html' %}
{% load static %}

{% block titulo %}NOTICIAS{% endblock titulo %}

{% block contenido %}
	<div class="submenu">
		<a href="{% url 'noticias:listar' %}">TODAS</a>
		{% for cat in categorias %}
			<a href="?categoria={{cat.pk}}">{{cat.nombre}}</a>
		{% endfor %}
	</div>

	<h1>ÚLTIMAS NOTICIAS DESTACADAS</h1>

	<!-- Formulario de filtros -->
	<form method="GET" action="">
		<div>
			<label for="fecha_inicio">Fecha Inicio:</label>
			<input type="date" id="fecha_inicio" name="fecha_inicio" value="{{ request.GET.fecha_inicio }}">
		</div>

		<div>
			<label for="fecha_fin">Fecha Fin:</label>
			<input type="date" id="fecha_fin" name="fecha_fin" value="{{ request.GET.fecha_fin }}">
		</div>

		<div>
			<label for="comentarios_min">Comentarios Mínimos:</label>
			<input type="number" id="comentarios_min" name="comentarios_min" value="{{ request.GET.comentarios_min }}" min="0">
		</div>

		<button type="submit">Aplicar Filtros</button>
	</form>

	<hr>

	<!-- Listado de noticias -->
	{% if noticias %}
		{% for noti in noticias %}
			<div>
				<img src="{{noti.imagen.url}}" width="100" height="100">
				<p><a href="{% url 'noticias:detalle' noti.pk %}">TÍTULO: {{noti.titulo}}</a></p>
				<p>FECHA: {{noti.fecha|date:"d-m-Y" }}</p>
				<p>CATEGORÍA: {{noti.categoria_noticia}}</p>
				<p>CUERPO: {{noti.cuerpo|truncatewords:20 }}</p>
				<p>COMENTARIOS: {{noti.comentario_set.count}}</p>
				<br><br>
			</div>
		{% endfor %}
	{% else %}
		<p>No hay noticias disponibles.</p>
	{% endif %}
{% endblock contenido %}